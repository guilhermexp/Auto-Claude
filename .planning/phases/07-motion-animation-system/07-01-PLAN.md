# Phase 07 - Plan 01: Motion & Animation System

**Phase:** 07-motion-animation-system
**Plan:** 01
**Wave:** 1
**Autonomous:** true
**Created:** 2026-01-21

---

## Objective

Criar sistema de animação centralizado com tokens formalizados (durations, easings), documentar animações CSS existentes, e adicionar suporte opcional a Motion para casos complexos, mantendo backward compatibility com animações CSS atuais.

**Purpose:** Animações criam sensação de fluidez, feedback visual imediato, e melhoram percepção de qualidade. Sistema de tokens garante consistência. Motion (Framer Motion v12) permite animações complexas quando CSS não é suficiente. Documentação clara facilita uso correto pelos desenvolvedores.

---

## Context

**Current State:**
- Motion (Framer Motion v12.23.26) JÁ instalado ✅
- 10+ @keyframes CSS já definidas (accordion, fade-in, slide-up, scale-in, pulse, indeterminate, progress, task-pulse, etc.) ✅
- Animation CSS variables parcialmente definidas (--animate-scale-in no @theme) ✅
- Tailwind animate classes usadas (data-[state=open]:animate-in, fade-in-0, zoom-in-95, etc.) ✅
- Motion NÃO usado em componentes ainda (oportunidade para adicionar suporte opcional)

**Discovery:**
```bash
# Motion já instalado
"motion": "^12.23.26"

# Animações CSS existentes em globals.css
@keyframes accordion-down, accordion-up
@keyframes fade-in, slide-up, scale-in
@keyframes pulse-subtle, indeterminate
@keyframes progress-glow-sweep, progress-sweep, status-pulse
@keyframes empty-bounce, task-pulse, stuck-pulse

# Animation variables (parcial)
--animate-scale-in: scale-in 0.2s cubic-bezier(0, 0, 0.2, 1);
```

**Scope Adjustment:**
ROADMAP original mencionava "criar animações para transições de páginas, modais, toasts, hover states, loading skeletons", mas:
1. Modais, toasts, overlays JÁ têm animações CSS funcionando (fade + zoom + slide)
2. Loading states JÁ têm pulse e indeterminate animations
3. Criar duplicatas seria redundante

**Decisão:** Focar em:
- Formalizar tokens de animação (durations, easings) no @theme
- Documentar animações CSS existentes
- Adicionar Motion variants OPCIONAIS para componentes que precisam (gestos, complex sequences)
- Manter animações CSS existentes (backward compatibility)

**Reference:**
- Design tokens: `apps/frontend/src/renderer/styles/globals.css` (@theme block)
- ui.md reference: Motion patterns (se existir)
- Tailwind animate utilities: fade-in, slide-in, zoom-in, etc.

**Dependencies:**
- Phase 01: Design Tokens Foundation
- Phase 02-06: Componentes base modernizados

---

## Tasks

### Task 1: Criar Animation Tokens

**Objective:** Formalizar tokens de animação (durations, easings, delays) no @theme block do globals.css.

**Files to modify:**
- `apps/frontend/src/renderer/styles/globals.css`

**Implementation:**
1. Adicionar animation duration tokens ao @theme:
   ```css
   /* Animation Durations */
   --duration-instant: 0ms;
   --duration-fast: 100ms;
   --duration-normal: 200ms;
   --duration-slow: 300ms;
   --duration-slower: 500ms;
   ```

2. Adicionar easing tokens ao @theme:
   ```css
   /* Animation Easings */
   --ease-linear: linear;
   --ease-in: cubic-bezier(0.4, 0, 1, 1);
   --ease-out: cubic-bezier(0, 0, 0.2, 1);
   --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
   --ease-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
   ```

3. Atualizar keyframes existentes para usar tokens:
   ```css
   @keyframes scale-in {
     from { transform: scale(0.95); opacity: 0 }
     to { transform: scale(1); opacity: 1 }
   }
   /* Usar via: animation: scale-in var(--duration-normal) var(--ease-out); */
   ```

4. Criar animation shorthand variables:
   ```css
   --animate-fade-in: fade-in var(--duration-normal) var(--ease-out);
   --animate-slide-up: slide-up var(--duration-normal) var(--ease-out);
   --animate-scale-in: scale-in var(--duration-normal) var(--ease-out);
   --animate-accordion-down: accordion-down var(--duration-normal) var(--ease-out);
   --animate-accordion-up: accordion-up var(--duration-normal) var(--ease-out);
   ```

5. Manter todos os @keyframes existentes (não deletar nada)

**Success criteria:**
- Build passa sem erros
- 5 duration tokens definidos
- 5 easing tokens definidos
- 5+ animation shorthand variables criadas
- Todos os @keyframes existentes preservados
- Zero breaking changes (animações existentes continuam funcionando)

**Commit format:** `feat(motion): add animation duration and easing tokens`

---

### Task 2: Adicionar Motion Variants aos Componentes Principais

**Objective:** Adicionar suporte OPCIONAL a Motion variants em Dialog e Tabs para casos de uso complexos.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/dialog.tsx`
- `apps/frontend/src/renderer/components/ui/tabs.tsx`

**Implementation:**

**Dialog - Motion variant opcional:**
1. Importar { motion } from 'motion/react'
2. Adicionar prop `useMotion?: boolean` ao DialogContentProps
3. Quando useMotion=true, usar motion.div em vez de DialogPrimitive.Content
4. Adicionar motion variants:
   ```typescript
   const dialogVariants = {
     hidden: { opacity: 0, scale: 0.95, y: 20 },
     visible: {
       opacity: 1,
       scale: 1,
       y: 0,
       transition: {
         duration: 0.2,
         ease: [0, 0, 0.2, 1] // --ease-out
       }
     },
     exit: {
       opacity: 0,
       scale: 0.95,
       transition: { duration: 0.15 }
     }
   };
   ```
5. Default: useMotion=false (usa animações CSS existentes)
6. Quando useMotion=true: usa Motion variants para animação programática

**Tabs - Motion indicator animado:**
1. Importar { motion } from 'motion/react'
2. Adicionar prop `animatedIndicator?: boolean` ao TabsListProps
3. Quando animatedIndicator=true, adicionar motion underline indicator
4. Track active tab e animar indicator position/width com layoutId
5. Default: animatedIndicator=false (usa CSS transitions existentes)

**Success criteria:**
- Build passa sem erros TypeScript
- Dialog aceita useMotion prop (opcional, default=false)
- Tabs aceita animatedIndicator prop (opcional, default=false)
- Animações CSS existentes continuam funcionando (backward compatibility)
- Motion só é usado quando explicitamente habilitado
- Zero breaking changes

**Commit format:** `feat(motion): add optional Motion variants to Dialog and Tabs`

---

### Task 3: Documentar Animation System

**Objective:** Criar documentação completa do sistema de animação (tokens, CSS keyframes, Motion variants, usage patterns).

**Files to create:**
- `.planning/phases/07-motion-animation-system/ANIMATIONS.md`

**Content structure:**
1. **Overview:** Introdução ao sistema de animação híbrido (CSS + Motion)
2. **Animation Tokens:**
   - Duration tokens (instant, fast, normal, slow, slower)
   - Easing tokens (linear, in, out, in-out, bounce)
   - Shorthand variables (--animate-fade-in, --animate-scale-in, etc.)
   - Tabela de referência completa
3. **CSS Animations:**
   - Lista de todos os @keyframes disponíveis (10+)
   - Exemplos de uso com Tailwind (data-[state=open]:animate-in)
   - Quando usar CSS animations (a maioria dos casos)
4. **Motion Variants:**
   - Dialog com useMotion prop
   - Tabs com animatedIndicator prop
   - Quando usar Motion (gestos, sequências complexas, layout animations)
5. **Usage Patterns:**
   - Overlay animations (Dialog, Popover, Tooltip)
   - List animations (stagger, enter/exit)
   - Loading states (pulse, indeterminate)
   - Hover/focus transitions
6. **Performance:**
   - CSS transforms vs opacity (GPU-accelerated)
   - Evitar animating layout properties (width, height) - use scale
   - prefer-reduced-motion support
7. **Accessibility:**
   - Respeitar prefers-reduced-motion
   - Durations não muito longas (200ms default)
   - Animações não impedem interação
8. **Integration:**
   - Com Phase 01 (tokens de cores para color transitions)
   - Com Phase 02-06 (componentes base)
   - Para Phase 08+ (dark mode transitions)
9. **Examples:**
   - Código completo de componentes usando Motion
   - CSS-only animation examples
   - Hybrid approaches

**Success criteria:**
- Documentação completa (~600-800 lines)
- Tabelas de referência para tokens
- 10+ exemplos de código
- Guia de performance e accessibility
- Quando usar CSS vs Motion decision guide

**Commit format:** `docs(motion): add comprehensive animation system documentation`

---

## Verification

After all tasks complete:

1. **Build verification:**
   ```bash
   cd apps/frontend && npm run build
   ```
   - Must build without errors
   - CSS bundle includes animation tokens
   - Motion tree-shaking works (only imports when used)

2. **Animation tokens verification:**
   - 5 duration tokens definidos
   - 5 easing tokens definidos
   - 5+ shorthand variables criadas
   - Accessíveis via `var(--duration-normal)`, `var(--ease-out)`, etc.

3. **Component API verification:**
   - Dialog: `<DialogContent useMotion={true}>` (opcional)
   - Tabs: `<TabsList animatedIndicator={true}>` (opcional)
   - Default behavior sem props = CSS animations (backward compatible)

4. **Documentation verification:**
   - ANIMATIONS.md existe e está completo
   - Todos os tokens documentados
   - Exemplos de código executáveis

---

## Success Criteria

- [ ] Animation tokens criados (5 durations, 5 easings, 5+ shorthands)
- [ ] Dialog tem Motion variant opcional (useMotion prop)
- [ ] Tabs tem animated indicator opcional (animatedIndicator prop)
- [ ] Documentação ANIMATIONS.md completa (~600-800 lines)
- [ ] Build passa sem erros
- [ ] Zero breaking changes (CSS animations continuam funcionando)
- [ ] Motion only used when explicitly enabled
- [ ] 3 commits criados (2 feat, 1 docs)

---

## Output

**Files Modified:**
- `apps/frontend/src/renderer/styles/globals.css` (animation tokens)
- `apps/frontend/src/renderer/components/ui/dialog.tsx` (optional Motion)
- `apps/frontend/src/renderer/components/ui/tabs.tsx` (optional animated indicator)

**Files Created:**
- `.planning/phases/07-motion-animation-system/ANIMATIONS.md` (documentação)

**Animation Tokens Added:**
- 5 duration tokens (instant 0ms → slower 500ms)
- 5 easing tokens (linear, in, out, in-out, bounce)
- 5+ shorthand animation variables

**Motion Integration:**
- Optional in Dialog (useMotion prop)
- Optional in Tabs (animatedIndicator prop)
- Default behavior = CSS animations (backward compatible)

**Commits:** 3 commits (2 feat, 1 docs)

**Documentation:** Comprehensive ANIMATIONS.md with token reference, CSS keyframes guide, Motion usage patterns, performance tips, and accessibility guide

**Next Phase:** Phase 08 (Dark Mode System) - Aprimorar dark mode tokens, toggle component, persistência, transitions

---

*Plan created: 2026-01-21*
*Estimated completion: 3 tasks, single wave execution*
