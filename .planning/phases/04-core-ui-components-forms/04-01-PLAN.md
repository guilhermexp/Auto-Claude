# Phase 04 - Plan 01: Form Components Modernization

**Phase:** 04-core-ui-components-forms
**Plan:** 01
**Wave:** 1
**Autonomous:** true
**Created:** 2026-01-21

---

## Objective

Modernizar componentes de formulário existentes com variantes type-safe, integração com tokens do design system, e criar componente FormField composition para uso consistente em formulários.

**Purpose:** Componentes de formulário são os mais usados na aplicação - garantir que todos sigam padrões modernos (cva + Radix UI + tokens) cria experiência consistente e facilita manutenção. FormField wrapper composition elimina repetição de código ao criar formulários.

---

## Context

**Current State:**
- Button, Checkbox, Switch já modernizados (usam Radix UI + cva + tokens)
- Input existe mas é básico (sem variantes, sem validation states)
- Label existe mas usa HTML nativo (deveria usar @radix-ui/react-label)
- Textarea existe mas sem variantes (resize hardcoded)
- RadioGroup existe mas sem orientação horizontal/vertical e usa gap-2 hardcoded
- Não existe FormField wrapper

**Reference:**
- Design tokens: `apps/frontend/src/renderer/styles/globals.css` (@theme block)
- Typography tokens: Phase 02 (9 sizes, 4 weights, 3 line heights)
- Spacing tokens: Phase 03 (13 values: 0-24, escala 4px)
- Button pattern: `apps/frontend/src/renderer/components/ui/button.tsx` (cva + forwardRef)
- ui.md reference: Input (lines 598-636), Label (lines 638-666)

**Dependencies:**
- Phase 01: Design Tokens Foundation (colors, shadows)
- Phase 02: Typography System (font sizes, weights)
- Phase 03: Spacing & Layout System (spacing tokens)

---

## Tasks

### Task 1: Modernizar Input com Variantes

**Objective:** Adicionar variantes ao componente Input usando cva para tamanhos e estados de validação.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/input.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar inputVariants com cva:
   - Variant `size`: sm (h-8 text-xs), default (h-9 text-sm), lg (h-11 text-base)
   - Variant `validation`: none, error (border-destructive), success (border-success), warning (border-warning)
3. Atualizar InputProps para incluir VariantProps<typeof inputVariants>
4. Aplicar inputVariants no className com cn()
5. Manter integração com tokens: border-border, bg-card, text-foreground, etc.
6. Preservar focus states: focus-visible:ring-[3px] focus-visible:ring-primary/20

**Success criteria:**
- Build passa sem erros TypeScript
- Input tem variantes de size (sm/default/lg)
- Input tem validation states (error/success/warning)
- Componente mantém ref forwarding
- Zero breaking changes para uso existente

**Commit format:** `feat(forms): add size and validation variants to Input component`

---

### Task 2: Modernizar Label com Radix UI

**Objective:** Migrar Label de HTML nativo para @radix-ui/react-label para melhor acessibilidade.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/label.tsx`

**Implementation:**
1. Importar LabelPrimitive de @radix-ui/react-label
2. Atualizar Label para usar LabelPrimitive.Root
3. Manter labelVariants com cva (já existe)
4. Atualizar tipos: React.ElementRef<typeof LabelPrimitive.Root>
5. Seguir padrão do ui.md (lines 638-666)
6. Font size: text-[12px] (seguir ui.md exato)

**Success criteria:**
- Build passa sem erros TypeScript
- Label usa Radix UI primitive
- Acessibilidade melhorada (for/id association automática)
- Componente mantém ref forwarding
- Zero breaking changes para uso existente

**Commit format:** `feat(forms): migrate Label to Radix UI primitive`

---

### Task 3: Modernizar Textarea com Variantes

**Objective:** Adicionar variantes ao Textarea usando cva para tamanhos e controle de resize.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/textarea.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar textareaVariants com cva:
   - Variant `size`: sm (min-h-[60px] text-xs px-2 py-1), default (min-h-[80px] text-sm px-3 py-2), lg (min-h-[120px] text-base px-4 py-3)
   - Variant `resize`: none (resize-none), vertical (resize-y), both (resize)
3. Atualizar TextareaProps para incluir VariantProps<typeof textareaVariants>
4. Aplicar textareaVariants no className com cn()
5. Manter integração com tokens: border-border, bg-card, text-foreground
6. Default variants: size: default, resize: vertical

**Success criteria:**
- Build passa sem erros TypeScript
- Textarea tem variantes de size (sm/default/lg)
- Textarea tem controle de resize (none/vertical/both)
- Componente mantém ref forwarding
- Zero breaking changes para uso existente

**Commit format:** `feat(forms): add size and resize variants to Textarea component`

---

### Task 4: Aprimorar RadioGroup com Orientação e Spacing Tokens

**Objective:** Adicionar variantes de orientação e usar spacing tokens em vez de gap-2 hardcoded.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/radio-group.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar radioGroupVariants com cva:
   - Variant `orientation`: vertical (grid gap-2), horizontal (flex flex-row gap-4)
   - Variant `spacing`: 1 (gap-1), 2 (gap-2), 3 (gap-3), 4 (gap-4)
3. Atualizar RadioGroup component para aceitar orientation e spacing props
4. Aplicar radioGroupVariants no className
5. Default variants: orientation: vertical, spacing: 2
6. Manter RadioGroupItem sem alterações (já está bom)

**Success criteria:**
- Build passa sem erros TypeScript
- RadioGroup suporta orientation (vertical/horizontal)
- RadioGroup usa spacing tokens via variantes
- Componente mantém ref forwarding
- Zero breaking changes para uso existente

**Commit format:** `feat(forms): add orientation and spacing variants to RadioGroup`

---

### Task 5: Criar Componente FormField

**Objective:** Criar wrapper composition FormField que combina Label + Input/Textarea + mensagens de erro/hint.

**Files to create:**
- `apps/frontend/src/renderer/components/ui/form-field.tsx`

**Implementation:**
1. Criar componente FormField com props:
   - `label`: string
   - `error?`: string
   - `hint?`: string
   - `required?`: boolean
   - `children`: React.ReactNode (Input, Textarea, Select, etc.)
2. Layout:
   - Label no topo (com asterisco * se required)
   - Children (input/textarea/etc)
   - Error message em vermelho (text-destructive text-xs mt-1) se error existe
   - Hint em muted (text-muted-foreground text-xs mt-1) se hint existe e não tem error
3. Usar Stack component (Phase 03) para spacing vertical: spacing={1}
4. Usar Text component (Phase 02) para error/hint messages: size="xs"
5. Conectar Label ao input via htmlFor/id (gerar ID único com useId)

**Success criteria:**
- Build passa sem erros TypeScript
- FormField renderiza Label + children + error/hint
- Label corretamente associado ao input (htmlFor/id)
- Spacing usa tokens (via Stack)
- Tipografia usa tokens (via Text)
- Componente é composable (aceita qualquer children)

**Commit format:** `feat(forms): create FormField wrapper component`

---

### Task 6: Criar Documentação FORMS.md

**Objective:** Documentar todos os componentes de formulário modernizados com exemplos de uso.

**Files to create:**
- `.planning/phases/04-core-ui-components-forms/FORMS.md`

**Content structure:**
1. **Overview:** Introdução ao sistema de formulários
2. **Components:**
   - Input: API, variantes (size, validation), exemplos
   - Label: API, integração Radix UI, acessibilidade
   - Textarea: API, variantes (size, resize), exemplos
   - RadioGroup: API, variantes (orientation, spacing), exemplos
   - FormField: API, composition pattern, exemplos completos
3. **Usage Patterns:**
   - Formulário básico (Label + Input)
   - Formulário com validação (FormField + error)
   - Formulário complexo (múltiplos campos)
   - Radio group horizontal vs vertical
4. **Accessibility:**
   - Label/input association
   - Error announcements
   - Focus management
   - Keyboard navigation
5. **Migration Guide:**
   - Como migrar de inputs básicos para novos componentes
   - Breaking changes (nenhum esperado)
   - Benefícios da migração
6. **Integration:**
   - Com Phase 01 (tokens de cores)
   - Com Phase 02 (tipografia)
   - Com Phase 03 (spacing)
   - Para Phase 05+ (overlays, navigation)

**Success criteria:**
- Documentação completa (~300-400 lines)
- Exemplos de código para cada componente
- Tabelas de referência para variantes
- Guia de acessibilidade
- Guia de migração

**Commit format:** `docs(forms): add comprehensive form components documentation`

---

## Verification

After all tasks complete:

1. **Build verification:**
   ```bash
   cd apps/frontend && npm run build
   ```
   - Must build without TypeScript errors
   - CSS bundle must include all new variants

2. **Component API verification:**
   - Input: `<Input size="sm" validation="error" />`
   - Label: `<Label htmlFor="input-id">Name</Label>`
   - Textarea: `<Textarea size="lg" resize="vertical" />`
   - RadioGroup: `<RadioGroup orientation="horizontal" spacing={4}>`
   - FormField: `<FormField label="Name" error="Required">`

3. **Token integration verification:**
   - Spacing usa tokens do Phase 03
   - Typography usa tokens do Phase 02
   - Colors usa tokens do Phase 01

4. **Documentation verification:**
   - FORMS.md existe e está completo
   - Exemplos de código são executáveis
   - Guias de migração e acessibilidade presentes

---

## Success Criteria

- [ ] Input modernizado com variantes (size, validation)
- [ ] Label migrado para Radix UI primitive
- [ ] Textarea modernizado com variantes (size, resize)
- [ ] RadioGroup aprimorado com orientation e spacing
- [ ] FormField component criado (composition pattern)
- [ ] Documentação FORMS.md completa
- [ ] Build passa sem erros TypeScript
- [ ] Zero breaking changes para componentes existentes
- [ ] Todos os componentes usam tokens do design system
- [ ] 6 commits criados (1 por task)

---

## Output

**Files Modified:**
- `apps/frontend/src/renderer/components/ui/input.tsx` (variantes adicionadas)
- `apps/frontend/src/renderer/components/ui/label.tsx` (Radix UI migration)
- `apps/frontend/src/renderer/components/ui/textarea.tsx` (variantes adicionadas)
- `apps/frontend/src/renderer/components/ui/radio-group.tsx` (orientation + spacing)

**Files Created:**
- `apps/frontend/src/renderer/components/ui/form-field.tsx` (novo wrapper)
- `.planning/phases/04-core-ui-components-forms/FORMS.md` (documentação)

**Commits:** 6 commits (feat x5, docs x1)

**Documentation:** Comprehensive FORMS.md with API reference, usage patterns, accessibility guide, and migration path

**Next Phase:** Phase 05 (Core UI Components - Overlays) - Dialog, Tooltip, Dropdown Menu, Select, Popover, Alert Dialog

---

*Plan created: 2026-01-21*
*Estimated completion: 6 tasks, single wave execution*
