# Phase 05 - Plan 01: Overlay Components Modernization

**Phase:** 05-core-ui-components-overlays
**Plan:** 01
**Wave:** 1
**Autonomous:** true
**Created:** 2026-01-21

---

## Objective

Modernizar componentes de overlay existentes (Dialog, Select, Popover, AlertDialog) com variantes type-safe usando cva, melhor integração com tokens do design system, e criar documentação completa OVERLAYS.md.

**Purpose:** Overlays são críticos para UX - precisam de animações suaves, acessibilidade perfeita, e variantes consistentes. Adicionar variantes type-safe (tamanho, tipo, estilo) cria flexibilidade mantendo consistência visual. Componentes de overlay bem implementados melhoram percepção de qualidade da aplicação.

---

## Context

**Current State:**
- Todos os 6 componentes já usam Radix UI primitives ✅
- Dialog: Completo (overlay, content, header, footer, title, description) mas sem variantes de tamanho
- Tooltip: Funcional com Provider mas sem variantes de tamanho/side
- DropdownMenu: Muito completo (submenus, checkbox, radio) - já está ótimo
- Select: Completo mas sem variantes de tamanho alinhadas com Input
- Popover: Simples mas sem variantes de width
- AlertDialog: Funcional mas sem variantes de tipo (info, warning, destructive)

**Components that DON'T need changes:**
- Tooltip ✅ - Simples e funcional, já usa tokens corretamente
- DropdownMenu ✅ - Já muito completo, não precisa de variantes adicionais

**Reference:**
- Design tokens: `apps/frontend/src/renderer/styles/globals.css` (@theme block)
- Spacing tokens: Phase 03 (13 values)
- Typography tokens: Phase 02 (9 sizes, 4 weights)
- Button pattern: `apps/frontend/src/renderer/components/ui/button.tsx` (cva + forwardRef)
- ui.md reference: Dialog (lines 735-856)

**Dependencies:**
- Phase 01: Design Tokens Foundation (colors, shadows, borders)
- Phase 02: Typography System (font sizes, weights)
- Phase 03: Spacing & Layout System (spacing tokens)
- Phase 04: Form Components (FormField pattern)

---

## Tasks

### Task 1: Modernizar Dialog com Variantes de Tamanho

**Objective:** Adicionar variantes de tamanho ao DialogContent usando cva para maior flexibilidade.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/dialog.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar dialogContentVariants com cva:
   - Variant `size`: sm (max-w-sm), default (max-w-lg), lg (max-w-2xl), xl (max-w-4xl), full (max-w-[95vw])
3. Atualizar DialogContentProps para incluir size?: VariantProps
4. Aplicar size variant no className de DialogContent
5. Manter hideCloseButton prop existente
6. Preservar todas as animações e overlay backdrop-blur-sm
7. Manter max-h-[90vh] para todos os tamanhos

**Success criteria:**
- Build passa sem erros TypeScript
- Dialog tem variantes de size (sm/default/lg/xl/full)
- Componente mantém hideCloseButton funcionando
- Animações e overlay preservados
- Zero breaking changes para uso existente

**Commit format:** `feat(overlays): add size variants to Dialog component`

---

### Task 2: Modernizar Select com Variantes de Tamanho

**Objective:** Adicionar variantes de tamanho ao SelectTrigger alinhadas com Input component.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/select.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar selectTriggerVariants com cva:
   - Variant `size`: sm (h-8 text-xs px-2), default (h-10 text-sm px-3), lg (h-12 text-base px-4)
   - Base styles: flex items-center justify-between rounded-lg border bg-card
3. Atualizar SelectTriggerProps para incluir size?: VariantProps
4. Aplicar size variant no className de SelectTrigger
5. Manter todos os focus states e transitions
6. Alinhar tamanhos com Input component (Phase 04)
7. Preservar ChevronDown icon e SelectValue

**Success criteria:**
- Build passa sem erros TypeScript
- Select tem variantes de size (sm/default/lg)
- Tamanhos alinhados com Input (h-8, h-10, h-12)
- Componente mantém todos os features (scroll buttons, portal, viewport)
- Zero breaking changes para uso existente

**Commit format:** `feat(overlays): add size variants to Select component`

---

### Task 3: Modernizar Popover com Variantes de Width

**Objective:** Adicionar variantes de largura ao PopoverContent para diferentes use cases.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/popover.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar popoverContentVariants com cva:
   - Variant `width`: sm (w-56), default (w-72), lg (w-96), auto (w-auto)
3. Atualizar PopoverContentProps para incluir width?: VariantProps
4. Aplicar width variant no className de PopoverContent
5. Manter align, sideOffset props existentes
6. Preservar todas as animações (fade, zoom, slide)
7. Manter z-50, rounded-md, border, shadow-md

**Success criteria:**
- Build passa sem erros TypeScript
- Popover tem variantes de width (sm/default/lg/auto)
- Componente mantém align e sideOffset props
- Animações preservadas
- Zero breaking changes para uso existente

**Commit format:** `feat(overlays): add width variants to Popover component`

---

### Task 4: Modernizar AlertDialog com Variantes de Tipo

**Objective:** Adicionar variantes de tipo (intent) ao AlertDialog para diferentes contextos.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/alert-dialog.tsx`

**Implementation:**
1. Importar cva e VariantProps
2. Criar alertDialogContentVariants com cva:
   - Variant `intent`: default (border-border), info (border-info), warning (border-warning), destructive (border-destructive)
   - Aplicar border color baseado no intent
3. Criar alertDialogTitleVariants com cva:
   - Variant `intent`: default (text-foreground), info (text-info), warning (text-warning), destructive (text-destructive)
4. Atualizar AlertDialogContent para aceitar intent prop
5. Atualizar AlertDialogTitle para aceitar intent prop
6. Passar intent do Content para Title automaticamente via context (usar React Context API)
7. Manter todas as animações e overlay backdrop-blur-sm

**Success criteria:**
- Build passa sem erros TypeScript
- AlertDialog tem variantes de intent (default/info/warning/destructive)
- Border e title color mudam baseado no intent
- Context API propaga intent de Content para Title
- Animações preservadas
- Zero breaking changes para uso existente

**Commit format:** `feat(overlays): add intent variants to AlertDialog component`

---

### Task 5: Integrar Overlays com Spacing Tokens

**Objective:** Substituir spacing hardcoded (space-y-2, mt-6, etc) por spacing tokens do Phase 03.

**Files to modify:**
- `apps/frontend/src/renderer/components/ui/dialog.tsx`
- `apps/frontend/src/renderer/components/ui/alert-dialog.tsx`

**Implementation:**
1. Dialog:
   - DialogHeader: space-y-2 (já usa token, manter)
   - DialogFooter: mt-6 → usar Stack component com spacing={6} ou manter mt-6 (é token)
2. AlertDialog:
   - AlertDialogHeader: space-y-2 (já usa token, manter)
   - AlertDialogFooter: mt-6 (já usa token, manter)
3. Verificar que todos os spacings já usam tokens (0.5rem = spacing-2, 1.5rem = spacing-6)
4. Documentar no OVERLAYS.md que spacing já integrado com tokens

**Success criteria:**
- Todos os spacings verificados contra tokens do Phase 03
- Documentação clara de spacing usage
- Zero visual changes (spacing já está correto)
- Zero breaking changes

**Commit format:** `refactor(overlays): document spacing token integration`

---

### Task 6: Criar Documentação OVERLAYS.md

**Objective:** Documentar todos os componentes de overlay com exemplos de uso, APIs, e patterns.

**Files to create:**
- `.planning/phases/05-core-ui-components-overlays/OVERLAYS.md`

**Content structure:**
1. **Overview:** Introdução ao sistema de overlays
2. **Components:**
   - **Dialog:** API, variantes (size), composition (Header/Footer/Title/Description), exemplos
   - **Tooltip:** API, usage com TooltipProvider, delay/positioning, exemplos
   - **DropdownMenu:** API, submenus, checkbox/radio items, shortcuts, separators, exemplos
   - **Select:** API, variantes (size), scroll buttons, grupos, exemplos
   - **Popover:** API, variantes (width), positioning, exemplos
   - **AlertDialog:** API, variantes (intent), vs Dialog comparison, exemplos
3. **Usage Patterns:**
   - Modal dialogs (form, confirmation)
   - Context menus
   - Command palettes
   - Selection dropdowns
   - Info popovers
   - Destructive confirmations
4. **Composition Patterns:**
   - Dialog + FormField (forms in modals)
   - DropdownMenu + Button (action menus)
   - Popover + Calendar (date pickers)
   - AlertDialog + destructive actions
5. **Accessibility:**
   - Keyboard navigation (Tab, Esc, Enter)
   - Focus trapping in modals
   - ARIA attributes (role, aria-label, aria-describedby)
   - Screen reader announcements
6. **Animation:**
   - Fade in/out
   - Zoom in/out
   - Slide from sides
   - Duration: 200ms (consistent)
7. **Integration:**
   - Com Phase 01 (tokens de cores e shadows)
   - Com Phase 02 (tipografia em titles/descriptions)
   - Com Phase 03 (spacing em headers/footers)
   - Com Phase 04 (FormField em dialogs)
8. **Migration Guide:**
   - Como migrar de modals customizados para Dialog
   - Quando usar Dialog vs AlertDialog vs Popover
   - Benefícios da padronização

**Success criteria:**
- Documentação completa (~600-800 lines)
- Exemplos de código para cada componente
- Tabelas de referência para variantes
- Guia de acessibilidade com keyboard shortcuts
- Guia de composição e patterns
- Migration guide e best practices

**Commit format:** `docs(overlays): add comprehensive overlay components documentation`

---

## Verification

After all tasks complete:

1. **Build verification:**
   ```bash
   cd apps/frontend && npm run build
   ```
   - Must build without TypeScript errors
   - CSS bundle must include all new variants

2. **Component API verification:**
   - Dialog: `<DialogContent size="lg">`
   - Select: `<SelectTrigger size="sm">`
   - Popover: `<PopoverContent width="lg">`
   - AlertDialog: `<AlertDialogContent intent="destructive">`

3. **Token integration verification:**
   - Dialog sizes use max-w-* tokens
   - Select sizes align with Input (h-8, h-10, h-12)
   - Popover widths use w-* tokens
   - AlertDialog intents use semantic color tokens

4. **Documentation verification:**
   - OVERLAYS.md exists and está completo
   - Exemplos de código são executáveis
   - Guias de acessibilidade, composição, e migração presentes

---

## Success Criteria

- [ ] Dialog modernizado com variantes de tamanho (sm/default/lg/xl/full)
- [ ] Select modernizado com variantes de tamanho (sm/default/lg)
- [ ] Popover modernizado com variantes de largura (sm/default/lg/auto)
- [ ] AlertDialog modernizado com variantes de intent (default/info/warning/destructive)
- [ ] Spacing integration documentado
- [ ] Documentação OVERLAYS.md completa
- [ ] Build passa sem erros TypeScript
- [ ] Zero breaking changes para componentes existentes
- [ ] Todos os componentes usam tokens do design system
- [ ] 6 commits criados (4 feat, 1 refactor, 1 docs)

---

## Output

**Files Modified:**
- `apps/frontend/src/renderer/components/ui/dialog.tsx` (size variants)
- `apps/frontend/src/renderer/components/ui/select.tsx` (size variants)
- `apps/frontend/src/renderer/components/ui/popover.tsx` (width variants)
- `apps/frontend/src/renderer/components/ui/alert-dialog.tsx` (intent variants)

**Files Created:**
- `.planning/phases/05-core-ui-components-overlays/OVERLAYS.md` (documentação)

**Components unchanged (already modern):**
- `tooltip.tsx` - ✅ Simples e funcional
- `dropdown-menu.tsx` - ✅ Muito completo

**Commits:** 6 commits (4 feat, 1 refactor, 1 docs)

**Documentation:** Comprehensive OVERLAYS.md with API reference, usage patterns, composition examples, accessibility guide, and migration path

**Next Phase:** Phase 06 (Core UI Components - Navigation) - Tabs, Navigation Menu, Breadcrumbs, Pagination, Sidebar

---

*Plan created: 2026-01-21*
*Estimated completion: 6 tasks, single wave execution*
